#!/usr/bin/env python
import os,sys,time,subprocess
definepath=os.getcwd()
sys.path.append("%s/bin/ftsrc/" % (definepath))
import include

try:
   import psyco
   psyco.full()
except ImportError:
   pass
definepath=os.getcwd()
sys.path.append("%s/bin/exploits/" % (definepath))
while 1==1:
   try:       
      include.print_banner()
      exploit1=raw_input("""

    This section will attempt to compile some exploits coded in python, generally 
    these exploits are from Muts, but may add others in time.

    Select your exploit:

    1.  HP OpenView Network Node Manager CGI Buffer Overflow
    2.  IBM Tivoli Storage Manager Express CAD Service Buffer Overflow 
    3.  HP Openview NNM 7.5.1 OVAS.EXE Pre Authentication SEH Overflow 
    4.  Quicktime 7.3 RTSP SEH Buffer Overflow
    5.  Goodtech SSH Server 6.4 Buffer Overflow
    6.  MS08-067 Microsoft Server Service Remote Buffer Overflow
    7.  mIRC 6.34 Remote Buffer Overflow Exploit
    8.  TFTP Server for Windows V1.4 ST
    9.  Internet Explorer XML Corruption Buffer Overflow
    10. MS Internet Explorer 7 Memory Corruption Exploit (MS09-002)
    11. MS Internet Explorer 7 DirectShow (msvidctl.dll) Heap Spray
    12. FireFox 3.5 Heap Spray Vulnerability
    
    (q)uit
 
    Enter number: """)

      if exploit1 == '1' :
         try:
            reload(hpopenview)
         except Exception: pass
         import hpopenview
      if exploit1 == '2' :
         try: reload(ibmcad)
         except Exception: pass
         import ibmcad
      if exploit1 == '3' :
         try: reload(hpopenviewnnm)
         except Exception: pass
         import hpopenviewnnm      
      if exploit1 == '4' :
         try: reload(quicktime)
         except Exception: pass
         import quicktime
      if exploit1 == '5' :
         try: reload(goodtech)
         except Exception: pass
         import goodtech
      if exploit1 == '6' :
         try: reload(ms08067run)
         except Exception: pass
         import ms08067run
      if exploit1 == '7' :
         try: reload(mirc)
         except Exception: pass
         import mirc
      if exploit1 == '8' :
         try: reload(tftp)
         except Exception: pass
         import tftp
      if exploit1 == '9' :
         try: reload(xmlcorruptionbo)
         except Exception: pass
         import xmlcorruptionbo
      if exploit1 == '10' :
         try: reload(ms09002)
         except Exception: pass
         import ms09002
      if exploit1 == '11' :
         try: reload(ie0day_activex)
         except Exception: pass
         import ie0day_activex
      if exploit1 == '12' :
         try: reload(firefox35)
         except Exception: pass
         import firefox35

      if exploit1 == 'q' :
         print "\nReturning to previous menu...\n"
         break
   except Exception, e:
      print "\n\n    The system may not be vulnerable. Printing Error: "+str(e)+"\n"
      print e
